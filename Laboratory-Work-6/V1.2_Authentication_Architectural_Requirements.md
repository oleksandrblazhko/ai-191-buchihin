# V1.2 Authentication Architectural Requirements

При розробці автентифікації не має значення, чи є у вас надійне апаратне забезпечення з увімкненою багатофакторною системою автентифікації, якщо зловмисник може скинути обліковий запис, зателефонувавши в кол-центр і відповівши на загальновідоме запитання. Під час підтвердження особи всі шляхи автентифікації повинні мати однакову силу.

## Опис
### 1.2.1 (CWE - 250)

Перевірте використання унікальних або спеціальних облікових записів операційної системи з низьким рівнем привілеїв для усіх компонентів програм, служб та серверів. (C3)

### 1.2.2 (CWE - 306)

Переконайтеся, що зв’язок між компонентами програми, включаючи API, проміжне програмне забезпечення та рівні даних проходять автентифікацію. Компоненти повинні мати хочаб найменш необхідні привілеї. (C3)

### 1.2.3 (CWE - 306)

Переконайтеся, що програма використовує єдиний перевірений механізм автентифікації, який відомий, як безпечний, розширюваний для включення надійної автентифікації та має достатній рівень логів і моніторингу для виявлення зловживань обліковим записом або порушень.

### 1.2.4 (CWE - 306)

Переконайтеся, що всі шляхи автентифікації та API керування ідентичністю реалізувують послідовну надійність контролю безпеки автентифікації, так що немає слабших альтернатив залежно від ризику застосування.

## Опис топ 10 найкращих проактивних елементів керування OWASP 2018
### C3: Убезпечте доступ до бази даних

У цьому розділі описано безпечний доступ до всіх сховищ даних, включаючи як реляційні бази даних, так і бази даних NoSQL. Деякі сфери, які варто розглянути:
 1. Убезпечте запити
 2. Убезпечте конфігурацію
 3. Убезпечте автентифікацію
 4. Убезпечте зв'язок

#### Убезпечте запити

SQL-ін’єкція відбувається, коли ненадійний ввід користувача динамічно додається до SQL-запиту в небезпечний спосіб, часто за допомогою базової конкатенації рядків. Впровадження SQL є одним із найнебезпечніших ризиків для безпеки програми. SQL Injection легко використати, і це може призвести до викрадення, видалення або зміни всієї бази даних. Програму можна навіть використовувати для виконання небезпечних команд проти операційної системи, у якій розміщена ваша база даних, таким чином даючи зловмиснику можливість закріпитися у вашій мережі.

Щоб пом’якшити впровадження SQL, слід запобігти інтерпретації ненадійного введення як частини команди SQL. Найкращий спосіб зробити це за допомогою техніки програмування, відомої як «Параметризація запиту». Цей захист слід застосовувати до SQL, OQL, а також до конструкції збережених процедур.

Гарний список прикладів параметризації запитів у ASP, ColdFusion, C#, Delphi, .NET, Go, Java, Perl, PHP, PL/SQL, PostgreSQL, Python, R, Ruby та Scheme можна знайти на http://bobby-tables.com і шпаргалка OWASP щодо параметризації запиту.

##### Застереження щодо параметризації запиту

Певні розташування в запиті до бази даних не можна параметризувати. Ці розташування різні для кожного постачальника бази даних. Будьте впевнені, що дуже ретельно виконуєте перевірку точної відповідності або ручне екранування, коли стикаєтеся з параметрами запиту до бази даних, які не можна прив’язати до параметризованого запиту. Крім того, хоча використання параметризованих запитів значною мірою позитивно впливає на продуктивність, певні параметризовані запити в конкретних реалізаціях бази даних впливатимуть на продуктивність негативно. Обов’язково тестуйте запити на продуктивність; особливо складні запити з великими можливостями пошуку подібних речень або тексту.

#### Убезпечте конфігурацію

На жаль, системи керування базами даних не завжди поставляються в конфігурації «захищено за замовчуванням». Необхідно подбати про те, щоб засоби керування безпекою, доступні в системі керування базами даних (СУБД) і платформі хостингу, увімкнуто та правильно налаштовано. Для більшості поширених СУБД існують стандарти, посібники та тести.

Короткі вказівки щодо забезпечення безпечної конфігурації можна знайти в шпаргалці бази даних.

#### Убезпечте автентифікацію

Весь доступ до бази даних має бути належним чином автентифікований. Автентифікація в СУБД має бути виконана безпечним способом. Автентифікація має відбуватися лише через безпечний канал. Облікові дані мають бути належним чином захищені та доступні для використання.

Короткі вказівки щодо забезпечення безпечного процесу автентифікації можна знайти в шпаргалці бази даних.

#### Убезпечте зв'язок

Більшість СУБД підтримують різноманітні методи зв’язку (служби, API тощо) – безпечні (автентифіковані, зашифровані) і незахищені (неавтентифіковані або незашифровані). Рекомендується використовувати лише параметри безпечного зв’язку відповідно до елемента керування Protect Data Everywhere.

Короткі вказівки щодо забезпечення засобів безпечного зв’язку можна знайти в шпаргалці бази даних.

## Опис CWE
### CWE 250
#### Розширений опис

Можуть бути виявлені нові недоліки, оскільки робота з додатковими правами, такими як root або адміністратор, може вимкнути звичайні перевірки безпеки, що виконуються операційною системою або навколишнім середовищем. Інші наявні недоліки можуть перетворитися на вразливі місця безпеки, якщо вони виникають під час роботи з підвищеними привілеями.

Функції керування привілеями можуть працювати менш ніж очевидними способами, і вони мають різні особливості на різних платформах. Ці невідповідності особливо виражені, якщо ви переходите від одного користувача не root до іншого. Обробники сигналів і породжені процеси запускаються з привілеями процесу-власника, тому, якщо процес працює як root, коли сигнал спрацьовує або виконується підпроцес, обробник сигналів або підпроцес працюватиме з привілеями root.

#### Платформи

Мови
Клас: не залежить від мови (невизначена поширеність)

Технології
Клас: мобільний (невизначена поширеність)

#### Загальні наслідки

Цілісність конфіденційності, Доступність ,Управління доступом
Технічний вплив: отримати привілеї або отримати ідентифікацію; Виконувати несанкціонований код або команди; Читати дані програми; DoS: збій, вихід або перезапуск
Зловмисник зможе отримати доступ до будь-яких ресурсів, дозволених додатковими привілеями. Загальні результати включають виконання коду, вимкнення служб і читання обмежених даних.

### CWE 306
#### Розширений опис

Оскільки дані переміщуються в хмару, якщо для доступу не потрібна автентифікація, зловмисникам може бути легше отримати доступ до даних з будь-якої точки Інтернету.

#### Платформи

Мови
Клас: не залежить від мови (невизначена поширеність)

Технології
Клас: хмарні обчислення (невизначена поширеність)
Клас: ICS/OT (часто поширений)

#### Загальні наслідки

Управління доступом, Інші
Технічний вплив: отримати привілеї або отримати ідентифікацію; Інший
Розкриття критичної функції надає зловмиснику рівень привілеїв цієї функції. Наслідки залежатимуть від пов’язаних функцій, але вони можуть варіюватися від читання чи зміни конфіденційних даних, доступу до адміністративних чи інших привілейованих функцій або, можливо, навіть виконання довільного коду.
